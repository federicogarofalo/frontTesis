<div class="content-wrapper">
  <div class="content">
    <div class="breadcrumb-wrapper">
      <h1>Información General</h1>
    </div>
    <div class="row">
      <div class="col-md-6 col-lg-6 col-xl-6">
        <div class="media widget-media p-4 bg-white border">
          <div (click)="showNodesHistory()" class="icon rounded-circle mr-4"
               [ngClass]="someNodesNotWorking ? 'bg-warning' : 'bg-success'"
               data-toggle="modal" data-target="#exampleModalGrid" style="cursor: pointer">
            <i *ngIf="!someNodesNotWorking" class="mdi mdi-check text-white "></i>
            <i *ngIf="someNodesNotWorking" class="mdi mdi-alert-circle-outline text-white "></i>
          </div>
          <div class="media-body align-self-center">
            <div class="progress mb-3">
              <div class="progress-bar" [ngClass]="activeNodesPercentage === 100 ? 'bg-success' : 'bg-warning'"
                   role="progressbar" [style.width]="activeNodesPercentage+'%'"
                   aria-valuenow="100" aria-valuemin="0"
                   aria-valuemax="100">{{ activeNodesPercentage + '%'}}</div>
            </div>
            <p>Porcentaje de nodos activos</p>
          </div>
        </div>
      </div>
      <div class="col-md-6 col-lg-6 col-xl-3">
        <div class="media widget-media p-4 bg-white border">
          <div class="icon rounded-circle mr-4 bg-primary">
            <i class="mdi mdi-thermometer-lines text-white "></i>
          </div>
          <div class="media-body align-self-center">
            <h4 class="text-primary mb-2">31°C</h4>
            <p>Temperatura del Parque</p>
          </div>
        </div>
      </div>
      <div class="col-md-6 col-lg-6 col-xl-3">
        <div class="media widget-media p-4 bg-white border">
          <div class="icon bg-success rounded-circle mr-4">
            <i class="mdi mdi-thermometer text-white "></i>
          </div>
          <div class="media-body align-self-center">
            <h4 class="text-primary mb-2">28°C</h4>
            <p>Temperatura Ambiente</p>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-6">
        <div class="card card-default">
          <div class="card-header card-header-border-bottom">
            <h2>Última Medición</h2>
          </div>
          <div class="card-body">
            <div style="display: block" *ngIf="barChartData">
              <canvas baseChart
                      [(datasets)]="barChartData"
                      [labels]="barChartLabels"
                      [options]="barChartOptions"
                      [legend]="barChartLegend"
                      [chartType]="barChartType"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="card card-default">
          <div class="card-header card-header-border-bottom">
            <h2>Últimas 10 Mediciones</h2>
          </div>
          <div class="card-body">
            <div style="display: block" *ngIf="lineChartData">
              <canvas baseChart
                      [(datasets)]="lineChartData"
                      [labels]="lineChartLabels"
                      [options]="lineChartOptions"
                      [legend]="lineChartLegend"
                      [chartType]="lineChartType"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Node History Modal -->
      <div class="modal fade" id="exampleModalGrid" tabindex="-1" role="dialog" aria-labelledby="exampleModalGrid" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalGridTitle">Historial de caida de nodos</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="modal-body">
                <table class="table">
                  <thead>
                  <tr>
                    <th scope="col">Nodo</th>
                    <th scope="col">Hora último control</th>
                    <th scope="col">Hora última trama</th>
                    <th scope="col">Descripción</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let history of nodeHistory">
                    <td>{{ history.node.module + ' ' + history.node.number }}</td>
                    <td>{{ history.control|date:'dd/MM/yyyy HH:mm:ss' }}</td>
                    <td>{{ history.lastFrame|date:'dd/MM/yyyy HH:mm:ss' }}</td>
                    <td>{{ history.description }}</td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="modal-footer"></div>
          </div>
        </div>
      </div>


    </div>
  </div>
</div>
